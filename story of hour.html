
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Quiz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: auto;
      padding: 20px;
      background-color: #f8f1e4;
    }

    .question {
      margin-bottom: 20px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }

    textarea {
      width: 95%;
      padding: 10px;
      border-radius: 10px;
      margin-top: 5px;
    }

    .options label {
      background-color: #e6d3b3;
      display: block;
      padding: 10px;
      margin: 5px 0;
      cursor: pointer;
      transition: transform 0.2s ease, background-color 0.2s ease;
      border-radius: 5px;
      font-weight: normal;
    }

    .options input[type="radio"] {
      display: none;
    }

    .options input[type="radio"]:checked + label {
      transform: translateY(-4px);
      background-color: #d4b78c;
    }

    #resultOverlay {
      background: #fff3cd;
      border: 1px solid #ffeeba;
      padding: 20px;
      border-radius: 10px;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      z-index: 1001;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      width: 90%;
      max-width: 500px;
      text-align: center;
    }

    .blur-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      backdrop-filter: blur(10px);
      background: rgba(0, 0, 0, 0.3);
      z-index: 1000;
      display: none;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 10px;
      border-radius: 5px;
    }

    button:hover {
      background: #0056b3;
    }

    .btn-secondary {
      background-color: #6c757d;
    }

    .btn-secondary:hover {
      background-color: #5a6268;
    }
  </style>
</head>
<body>
<h2>“The Story of an Hour” Quiz</h2>

<div id="blurOverlay" class="blur-overlay"></div>

<div id="resultOverlay">
  <div id="resultBox"></div>
  <button id="finishBtn" onclick="window.location.reload()">Finish & Retake Quiz</button>
  <button onclick="window.location.href='quiz.html'" class="btn-secondary">Go Back</button>
</div>

<form id="quizForm">
  <div class="question">
    <label>1. What news does Mrs. Mallard receive at the beginning of the story?</label>
    <div class="options">
      <input type="radio" id="q1a" name="q1" value="A" /><label for="q1a">A. She won the lottery</label>
      <input type="radio" id="q1b" name="q1" value="B" /><label for="q1b">B. Her sister is getting married</label>
      <input type="radio" id="q1c" name="q1" value="C" /><label for="q1c">C. Her husband has died in an accident</label>
      <input type="radio" id="q1d" name="q1" value="D" /><label for="q1d">D. Her house burned down</label>
    </div>
  </div>

  <div class="question">
    <label>2. How does Mrs. Mallard react at first to her husband’s death?</label>
    <div class="options">
      <input type="radio" id="q2a" name="q2" value="A" /><label for="q2a">A. She screams in anger</label>
      <input type="radio" id="q2b" name="q2" value="B" /><label for="q2b">B. She runs away</label>
      <input type="radio" id="q2c" name="q2" value="C" /><label for="q2c">C. She weeps with sudden, wild abandonment</label>
      <input type="radio" id="q2d" name="q2" value="D" /><label for="q2d">D. She faints</label>
    </div>
  </div>

  <div class="question">
    <label>3. What surprising feeling does Mrs. Mallard experience after grieving?</label>
    <div class="options">
      <input type="radio" id="q3a" name="q3" value="A" /><label for="q3a">A. Loneliness</label>
      <input type="radio" id="q3b" name="q3" value="B" /><label for="q3b">B. Relief and freedom</label>
      <input type="radio" id="q3c" name="q3" value="C" /><label for="q3c">C. Guilt</label>
      <input type="radio" id="q3d" name="q3" value="D" /><label for="q3d">D. Terror</label>
    </div>
  </div>

  <div class="question">
    <label>4. What happens at the end of the story?</label>
    <div class="options">
      <input type="radio" id="q4a" name="q4" value="A" /><label for="q4a">A. Mrs. Mallard runs away with another man</label>
      <input type="radio" id="q4b" name="q4" value="B" /><label for="q4b">B. Her husband returns alive, and she dies</label>
      <input type="radio" id="q4c" name="q4" value="C" /><label for="q4c">C. She marries again</label>
      <input type="radio" id="q4d" name="q4" value="D" /><label for="q4d">D. She leaves the house quietly</label>
    </div>
  </div>

  <div class="question">
    <label>5. What is the main theme of the story?</label>
    <div class="options">
      <input type="radio" id="q5a" name="q5" value="A" /><label for="q5a">A. Revenge</label>
      <input type="radio" id="q5b" name="q5" value="B" /><label for="q5b">B. The mystery of death</label>
      <input type="radio" id="q5c" name="q5" value="C" /><label for="q5c">C. Female independence and emotional freedom</label>
      <input type="radio" id="q5d" name="q5" value="D" /><label for="q5d">D. Marriage and tradition</label>
    </div>
  </div>

  <div class="question">
    <label for="q6">6. Why is the story's title ironic?</label>
    <textarea id="q6"></textarea>
  </div>

  <div class="question">
    <label for="q7">7. How does the author use the setting (the open window, the springtime) to reflect Mrs. Mallard’s emotions?</label>
    <textarea id="q7"></textarea>
  </div>

  <div class="question">
    <label for="q8">8. What do you think Mrs. Mallard means when she whispers, “Free, free, free”?</label>
    <textarea id="q8"></textarea>
  </div>

  <div class="question">
    <label for="q9">9. Why is the ending considered a twist?</label>
    <textarea id="q9"></textarea>
  </div>

  <div class="question">
    <label for="q10">10. Do you think Mrs. Mallard was selfish or misunderstood? Explain your answer.</label>
    <textarea id="q10"></textarea>
  </div>
</form>

    <button type="button" onclick="submitQuiz()">Submit Quiz</button>
  </form>

<script>const answers = {
  q1: "C",
  q2: "C",
  q3: "B",
  q4: "B",
  q5: "C"
};

const openAnswers = {
  q6: "The title is ironic because a whole life changes in just an hour, and Mrs. Mallard dies when her freedom is lost.",
  q7: "The open window and spring represent renewal and freedom, echoing her emotional awakening.",
  q8: "She realizes she is free from societal and marital expectations.",
  q9: "The ending is a twist because her husband is alive, and the shock kills her.",
  q10: "She is misunderstood; she wasn't glad her husband died, but she felt relief from societal expectations."
};

  function stringSimilarity(a, b) {
    const wordsA = a.toLowerCase().split(/\W+/).filter(Boolean);
    const wordsB = b.toLowerCase().split(/\W+/).filter(Boolean);
    const matches = wordsA.filter(word => wordsB.includes(word));
    return matches.length / Math.max(wordsA.length, 1);
  }

  function submitQuiz() {
    let score = 0;
    let feedback = [];
    let openScores = {};

    for (let i = 1; i <= 5; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (selected) {
        localStorage.setItem(`q${i}`, selected.value);
      }
    }

    for (let i = 6; i <= 10; i++) {
      const text = document.getElementById(`q${i}`).value.trim();
      localStorage.setItem(`q${i}`, text);
    }

    for (let i = 1; i <= 5; i++) {
      const userAnswer = localStorage.getItem(`q${i}`);
      const correct = answers[`q${i}`];
      if (userAnswer === correct) {
        score++;
        feedback.push(`Q${i}: ✅ Correct`);
      } else {
        feedback.push(`Q${i}: ❌ Incorrect (Correct: ${correct})`);
      }
    }

    for (let i = 6; i <= 10; i++) {
      const userInput = localStorage.getItem(`q${i}`) || "";
      const correct = openAnswers[`q${i}`];
      let rate10 = 0;
      let score5 = 0;

      if (userInput.trim().length > 5) {
        const similarity = stringSimilarity(userInput, correct);
        rate10 = Math.round(similarity * 10);
        score5 = Math.round(similarity * 5);
        score += score5 / 5;
      }

      feedback.push(`Q${i}: Similarity ${rate10}/10 ➜ Score: ${score5}/5`);
      openScores[`q${i}_score`] = score5;
    }

    const finalScore = Math.round(score * 10) / 10;
    localStorage.setItem("userScore", finalScore);

    const activeUser = localStorage.getItem("activeUser");
    let allScores = JSON.parse(localStorage.getItem("quizScores") || "{}");

    if (activeUser) {
      if (!allScores[activeUser]) {
        allScores[activeUser] = [];
      }
      allScores[activeUser].push(finalScore);
      localStorage.setItem("quizScores", JSON.stringify(allScores));
    }

    Object.keys(openScores).forEach(key => {
      localStorage.setItem(key, openScores[key]);
    });

    const resultBox = document.getElementById("resultBox");
    resultBox.innerHTML = `<h3>Your Total Score: ${finalScore}/10</h3>`;
    feedback.forEach(line => {
      const p = document.createElement("p");
      p.textContent = line;
      resultBox.appendChild(p);
    });

    document.getElementById("blurOverlay").style.display = "block";
    document.getElementById("resultOverlay").style.display = "block";
  }
</script>
</body>
</html>